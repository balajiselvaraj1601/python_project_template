"""Utility functions for common operations.

This module provides reusable utility functions including:
- Performance measurement decorators for timing function execution
- Logging integration via the centralized logging manager
"""

import functools
import time
from collections.abc import Callable
from typing import Any

from src.core.logging_manager import get_logger

logger = get_logger(__name__)

def time_execution(func: Callable) -> Callable:
    @functools.wraps(func)
    def wrapper(*args, **kwargs) -> Any:
        start_time = time.perf_counter()

        result = func(*args, **kwargs)

        end_time = time.perf_counter()
        duration = round(end_time - start_time, 4)

        logger.info(f"Execution time for {func.__name__}: {duration} seconds")

        return result
    return wrapper

def handle_errors(func: Callable) -> Callable:
    @functools.wraps(func)
    def wrapper(*args, **kwargs) -> dict[str, Any]:

        try:
            data = func(*args, **kwargs)
            return {
                'status': 'success',
                'report': f'{func.__name__} completed successfully with params {args} {kwargs}',
                'data': data
            }
        except ValueError as e:
            return {
                'status': 'error',
                'error': f'Validation Error: {e!s}',
                'report': f'{func.__name__} failed validation with params {args} {kwargs}'
            }
        except Exception as e:
            return {
                'status': 'error',
                'error': f'Unexpected: {e!s}',
                'report': f'{func.__name__} encountered a system error with params {args} {kwargs}'
            }
    return wrapper
