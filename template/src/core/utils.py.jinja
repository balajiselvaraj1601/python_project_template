"""System and environment utility helpers.

This module contains small utilities for probing the runtime environment,
such as detecting the presence of vendor-specific hardware or tools.

These helpers are intentionally lightweight and use only the standard library
so they are safe to call during initialization and in CI.

"""

from __future__ import annotations

import shutil
import subprocess

# =============================================================================
# GPU DETECTION UTILITIES
# =============================================================================

def has_nvidia_gpu() -> bool:
    """Check if an NVIDIA GPU is available on the system.

    This function attempts to run the ``nvidia-smi`` command, which is a
    utility provided by NVIDIA for monitoring GPU status. If the command
    executes successfully, it indicates that an NVIDIA GPU is present and
    accessible.

    Returns:
        bool: True if an NVIDIA GPU is detected, False otherwise.

    Examples:
        if has_nvidia_gpu():
            print("NVIDIA GPU detected")

    Raises:
        No exceptions are raised for normal execution; subprocess/Cmd errors
        are caught and interpreted as no GPU present.

    Note:
        This function is specific to NVIDIA GPUs and will return False on
        systems without NVIDIA drivers or on non-NVIDIA hardware (e.g., AMD,
        Intel integrated graphics, or Apple Silicon).
    """
    cmd = shutil.which("nvidia-smi")
    if cmd is None:
        return False
    try:
        subprocess.check_output([cmd])
    except subprocess.CalledProcessError:
        return False
    else:
        return True
